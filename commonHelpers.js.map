{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["const API_KEY = '43047310-ec96e83c6d494f225a37e8405';\nimport axios from 'axios';\n\nconst PER_PAGE = 15;\nlet currentPage = 1;\n\nexport async function searchImages(keyword) {\n  const url = `https://pixabay.com/api/?key=${API_KEY}&q=${encodeURIComponent(\n    keyword\n  )}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=${PER_PAGE}`;\n\n  try {\n    const response = await axios.get(url);\n    const data = response.data;\n    const totalHits = data.totalHits;\n    return {\n      images: data.hits.map(image => ({\n        webformatURL: image.webformatURL,\n        largeImageURL: image.largeImageURL,\n        tags: image.tags,\n        likes: image.likes,\n        views: image.views,\n        comments: image.comments,\n        downloads: image.downloads,\n      })),\n      totalHits,\n    };\n  } catch (error) {\n    throw new Error('Failed to fetch images from Pixabay API');\n  }\n}\n\nexport function resetPage() {\n  currentPage = 1;\n}\n\nexport function increasePage() {\n  currentPage++;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox = null;\n\n// Получаем высоту одной карточки галереи\nfunction getGalleryCardHeight() {\n  const galleryCard = document.querySelector('.image-container');\n  const cardHeight = galleryCard.getBoundingClientRect().height;\n  return cardHeight;\n}\n\n// Прокручиваем страницу на две высоты карточки галереи\nfunction scrollToNextGroup() {\n  const cardHeight = getGalleryCardHeight();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth', // Делаем прокрутку плавной\n  });\n}\n\n// Определение функции clearGallery\nexport function clearGallery() {\n  const gallery = document.querySelector('.gallery');\n  gallery.innerHTML = '';\n}\n\n// Определение функции renderImages\nexport function renderImages(images, append = false) {\n  const gallery = document.querySelector('.gallery');\n\n  // Функция для создания <li> с <p> и классом\n  function createListItemWithParagraph(label, value, className) {\n    const listItem = document.createElement('li');\n    listItem.textContent = `${label}`;\n    listItem.classList.add(className); // Добавление класса к <li>\n    const paragraph = document.createElement('p');\n    paragraph.textContent = `${value}`;\n    listItem.appendChild(paragraph); // Добавление <p> к <li>\n    return listItem;\n  }\n\n  // Создаем или очищаем галерею в зависимости от флага append\n  if (!append) {\n    gallery.innerHTML = '';\n  }\n\n  images.forEach(image => {\n    // Создаем элемент ссылки для каждого изображения\n    const link = document.createElement('a');\n    link.href = image.largeImageURL;\n    link.dataset.src = image.largeImageURL; // Добавляем data-src для SimpleLightbox\n\n    // Создаем элемент изображения\n    const img = document.createElement('img');\n    img.src = image.webformatURL;\n    img.alt = image.tags;\n    img.title = image.tags;\n\n    // Добавляем изображение к ссылке\n    link.appendChild(img);\n\n    // Создаем список с данными\n    const dataList = document.createElement('ul');\n    dataList.classList.add('my-ul-class');\n\n    // Создаем элемент <li> для каждого значения и добавляем к <ul>\n    const likesItem = createListItemWithParagraph(\n      'Likes:',\n      image.likes,\n      'my-li-class'\n    );\n    const viewsItem = createListItemWithParagraph(\n      'Views:',\n      image.views,\n      'my-li-class'\n    );\n    const commentsItem = createListItemWithParagraph(\n      'Comments:',\n      image.comments,\n      'my-li-class'\n    );\n    const downloadsItem = createListItemWithParagraph(\n      'Downloads:',\n      image.downloads,\n      'my-li-class'\n    );\n\n    dataList.appendChild(likesItem);\n    dataList.appendChild(viewsItem);\n    dataList.appendChild(commentsItem);\n    dataList.appendChild(downloadsItem);\n\n    // Создаем элемент для размещения списка данных\n    const info = document.createElement('div');\n    info.classList.add('image-info');\n    info.appendChild(dataList);\n\n    // Создаем контейнер для изображения и данных\n    const container = document.createElement('div');\n    container.classList.add('image-container');\n    container.appendChild(link);\n    container.appendChild(info);\n\n    // Добавляем контейнер к галерее\n    gallery.appendChild(container);\n  });\n\n  // Создаем или обновляем SimpleLightbox\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a');\n  } else {\n    lightbox.refresh();\n  }\n\n  // Прокручиваем страницу на две высоты карточки галереи\n  scrollToNextGroup();\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { searchImages, resetPage, increasePage } from './js/pixabay-api';\nimport { renderImages } from './js/render-functions';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const searchForm = document.getElementById('search-form');\n  const gallery = document.getElementById('gallery');\n  const loader = document.getElementById('loader');\n\n  let page = 1;\n  let query = '';\n  let maxPage = 1;\n  let loadMoreBtn;\n\n  function showError(message) {\n    iziToast.error({\n      title: 'Error',\n      position: 'topRight',\n      message: message,\n    });\n  }\n\n  function showLoader() {\n    loader.style.display = 'block';\n  }\n\n  function hideLoader() {\n    loader.style.display = 'none';\n  }\n\n  function checkLoadMoreBtnVisibility() {\n    if (page <= maxPage) {\n      loadMoreBtn.classList.remove('hidden');\n    } else {\n      loadMoreBtn.classList.add('hidden');\n      showError(\"We're sorry, but you've reached the end of search results.\");\n    }\n  }\n\n  searchForm.addEventListener('submit', async event => {\n    event.preventDefault();\n\n    query = event.target.elements.query.value.trim();\n    if (!query) {\n      showError('Please enter a search query');\n      return;\n    }\n\n    showLoader();\n    resetPage();\n\n    try {\n      const { images, totalHits } = await searchImages(query, page);\n      renderImages(images);\n      maxPage = Math.ceil(totalHits / 15);\n    } catch (error) {\n      showError('Failed to fetch images. Please try again later.');\n    } finally {\n      hideLoader();\n      checkLoadMoreBtnVisibility();\n      window.scrollBy({\n        top: gallery.getBoundingClientRect().height * 2,\n        behavior: 'smooth',\n      });\n    }\n  });\n\n  loadMoreBtn = document.querySelector('.js-btn-load');\n\n  loadMoreBtn.addEventListener('click', async () => {\n    increasePage();\n    showLoader();\n    try {\n      const { images, totalHits } = await searchImages(query, page);\n      renderImages(images, true); // Передаем второй аргумент для добавления новых изображений\n      maxPage = Math.ceil(totalHits / 15);\n    } catch (error) {\n      showError('Failed to fetch more images. Please try again later.');\n    } finally {\n      hideLoader();\n      checkLoadMoreBtnVisibility();\n      window.scrollBy({\n        top: gallery.getBoundingClientRect().height * 2,\n        behavior: 'smooth',\n      });\n    }\n  });\n\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n  });\n});\n"],"names":["API_KEY","PER_PAGE","currentPage","searchImages","keyword","url","data","axios","totalHits","image","resetPage","increasePage","lightbox","getGalleryCardHeight","scrollToNextGroup","cardHeight","renderImages","images","append","gallery","createListItemWithParagraph","label","value","className","listItem","paragraph","link","img","dataList","likesItem","viewsItem","commentsItem","downloadsItem","info","container","SimpleLightbox","searchForm","loader","page","query","maxPage","loadMoreBtn","showError","message","iziToast","showLoader","hideLoader","checkLoadMoreBtnVisibility","event"],"mappings":"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"}